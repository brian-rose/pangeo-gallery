<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bias Correction &#8212; Pangeo Gallery  documentation</title>
    <link rel="stylesheet" href="../../../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../../_static/pangeo-style.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="https://netdna.bootstrapcdn.com/font-awesome/5.0.0/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/pangeo-gallery.css" />
    <script id="documentation_options" data-url_root="../../../../../../" src="../../../../../../_static/documentation_options.js"></script>
    <script src="../../../../../../_static/jquery.js"></script>
    <script src="../../../../../../_static/underscore.js"></script>
    <script src="../../../../../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../search.html" />
    <link rel="next" title="How to calculate ocean heat content" href="../Ocean-Heat-Content/OHC_tutorial.html" />
    <link rel="prev" title="Plot MPAS data using Delauney Triangulation" href="../../Binderbot-Bug28/mpas/plot_terrain.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../../../../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../../../../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../../../../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../../../../../_static/bootstrap-sphinx.js "></script>

  </head><body>
<div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
  <div class="container">
    <div class="navbar-header">
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../../../../../index.html">
          <span><img src="../../../../../../_static/small_e_reversed_24px.png"></span>
        Pangeo Gallery</a>
    </div>

    <div class="collapse navbar-collapse nav-collapse">
      <ul class="nav navbar-nav">
      <li>
      <nav id="pangeo-breadcrumb" aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="../../../index.html">NCAR Gallery</a></li>
        
          <li class="breadcrumb-item active"><a href="#">Bias Correction</a></li>
        
        </ol>
      </nav>
      </li>
      </ul>
    </div>

  </div>
</div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary">





<div class="badges" id="sidebar-header">
  <p><i class="fa fa-github fa-lg"></i> <a target="_blank" href="https://github.com/NCAR/notebook-gallery/blob/master/bias_correction.ipynb">NCAR/notebook-gallery/bias_correction.ipynb</a></p>
  <a target="_blank" href="https://binder.pangeo.io/v2/gh/NCAR/notebook-gallery/main/?urlpath=git-pull?repo=https://github.com/NCAR/notebook-gallery%26amp%3Burlpath=lab/tree/Bias-Correction/bias_correction.ipynb%3Fautodecode"><img alt="Launch Binder" src="https://mybinder.org/badge_logo.svg?style=flat-square" /></a>
</div>

<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../../contributing.html">Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../cesm-lens-aws/index.html">Gallery for CESM LENS on AWS</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">NCAR Gallery</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../Binderbot-Bug28/mpas/plot_terrain.html">Plot MPAS data using Delauney Triangulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Binderbot-Bug28/mpas/plot_terrain.html#Read-data-from-MPAS-file">Read data from MPAS file</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Bias Correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ocean-Heat-Content/OHC_tutorial.html">How to calculate ocean heat content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../WRF/wrf_ex.html">WRF data and Xarray</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mpas/plot_of_surface_pressure_on_mpas_grid.html">Plot of Surface Pressure on MPAS grid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mpas/plot_of_surface_pressure_on_mpas_grid.html#Get-Data">Get Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mpas/plot_of_surface_pressure_on_mpas_grid.html#Read-Data-from-MPAS-Grid">Read Data from MPAS Grid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mpas/plot_of_surface_pressure_on_mpas_grid.html#Convert-to-degrees-from-radians">Convert to degrees from radians</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mpas/plot_of_surface_pressure_on_mpas_grid.html#Global-tripcolor-plot">Global tripcolor plot</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../TomAugspurger/pangeo-dask-gateway/index.html">Pangeo &amp; Dask Gateway.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../earthcube2020/ec20_abernathey_etal/index.html">Cloud Storage Benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../pangeo-data/landsat-8-tutorial-gallery/index.html">Landsat 8 Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../pangeo-data/pangeo-tutorial-gallery/index.html">Pangeo Tutorial Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../pangeo-gallery/cmip6/index.html">CMIP6 Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../pangeo-gallery/example-gallery/index.html">Example Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../pangeo-gallery/physical-oceanography/index.html">Physical Oceanography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../rsignell-usgs/esip-gallery/index.html">ESIP Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../xgcm/xgcm-examples/index.html">Gallery for XGCM Examples and Usecases</a></li>
</ul>

        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Bias-Correction">
<h1>Bias Correction<a class="headerlink" href="#Bias-Correction" title="Permalink to this headline">¶</a></h1>
<p>This notebook demonstrates z-score bias correction in 4 steps:</p>
<ol class="arabic simple">
<li><p>Look at zonal wind data</p></li>
<li><p>Filtering the data to the extent of Colorado</p></li>
<li><p>Aligning the datasets in time</p></li>
<li><p>A z-score bias correction method</p></li>
</ol>
<div class="section" id="Set-up-Workspace">
<h2>Set up Workspace<a class="headerlink" href="#Set-up-Workspace" title="Permalink to this headline">¶</a></h2>
<p>Import all necessary modules and name the variable we will be looking at (zonal wind speed, <code class="docutils literal notranslate"><span class="pre">uas</span></code>).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">interpolate</span><span class="p">,</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">xesmf</span> <span class="k">as</span> <span class="nn">xe</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span> <span class="nn">ngallery_utils</span> <span class="kn">import</span> <span class="n">DATASETS</span>

<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">var</span> <span class="o">=</span> <span class="s1">&#39;uas&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="1.-Look-at-Data">
<h2>1. Look at Data<a class="headerlink" href="#1.-Look-at-Data" title="Permalink to this headline">¶</a></h2>
<p>We have 3 datasets for this correction: a historical model, a future rcp85 model, and measurements.</p>
<p>Ultimately, the historical model will be compared to the measurements to predict an adjustment to the future rcp85 model to be more like future measurements.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">hist_file</span> <span class="o">=</span> <span class="n">DATASETS</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s2">&quot;uas.hist.CanESM2.CRCM5-UQAM.day.NAM-44i.raw.Colorado.nc&quot;</span><span class="p">)</span>
<span class="n">rcp85_file</span> <span class="o">=</span> <span class="n">DATASETS</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s2">&quot;uas.rcp85.CanESM2.CRCM5-UQAM.day.NAM-44i.raw.Colorado.nc&quot;</span><span class="p">)</span>
<span class="n">meas_file</span> <span class="o">=</span> <span class="n">DATASETS</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s2">&quot;uas.gridMET.NAM-44i.Colorado.nc&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Downloading file &#39;uas.hist.CanESM2.CRCM5-UQAM.day.NAM-44i.raw.Colorado.nc&#39; from &#39;ftp://ftp.cgd.ucar.edu/archive/aletheia-data/tutorial-data/uas.hist.CanESM2.CRCM5-UQAM.day.NAM-44i.raw.Colorado.nc&#39; to &#39;/home/jovyan/aletheia-data/tutorial-data&#39;.
Downloading file &#39;uas.rcp85.CanESM2.CRCM5-UQAM.day.NAM-44i.raw.Colorado.nc&#39; from &#39;ftp://ftp.cgd.ucar.edu/archive/aletheia-data/tutorial-data/uas.rcp85.CanESM2.CRCM5-UQAM.day.NAM-44i.raw.Colorado.nc&#39; to &#39;/home/jovyan/aletheia-data/tutorial-data&#39;.
Downloading file &#39;uas.gridMET.NAM-44i.Colorado.nc&#39; from &#39;ftp://ftp.cgd.ucar.edu/archive/aletheia-data/tutorial-data/uas.gridMET.NAM-44i.Colorado.nc&#39; to &#39;/home/jovyan/aletheia-data/tutorial-data&#39;.
</pre></div></div>
</div>
# Or if not on Cheyenne
hist_file = DATASERTS.fetch("/uas.hist.CanESM2.CRCM5-UQAM.day.NAM-44i.raw.Colorado.nc")
rcp85_file = DATASERTS.fetch("/uas.rcp85.CanESM2.CRCM5-UQAM.day.NAM-44i.raw.Colorado.nc")
meas_file = DATASETS.fetch("uas.gridMET.NAM-44i.Colorado.nc")<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ds_hist</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">hist_file</span><span class="p">)</span>
<span class="n">ds_hist</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:    (bnds: 2, lat: 8, lon: 16, time: 20440)
Coordinates:
  * time       (time) object 1950-01-01 12:00:00 ... 2005-12-31 12:00:00
  * lat        (lat) float64 37.25 37.75 38.25 38.75 39.25 39.75 40.25 40.75
  * lon        (lon) float64 -109.8 -109.2 -108.8 ... -103.2 -102.8 -102.2
Dimensions without coordinates: bnds
Data variables:
    uas        (time, lat, lon) float32 ...
    time_bnds  (time, bnds) object 1950-01-01 00:00:00 ... 2006-01-01 00:00:00
Attributes:
    Conventions:                    CF-1.4
    institution:                    Universite du Quebec a Montreal
    contact:                        Winger.Katja@uqam.ca
    comment:                        CORDEX North America CRCM5 v333 0.44 deg ...
    model:                          CRCM5 (dynamics GEM v_3.3.3, physics RPN ...
    model_grid:                     rotated lat-lon 236x241 incl. 10p pilot a...
    geophysical_fields:             orography: USGS / land use cover: USGS / ...
    physics:                        land: CLASS3.5+, 26L, bottom at 60m / lak...
    forcing:                        GHG: CO2,CH4,N2O,CFC11,effective CFC12
    creation_date:                  2012-09-06
    experiment:                     historical
    experiment_id:                  historical
    driving_model_ensemble_member:  r1i1p1
    driving_experiment_name:        historical
    frequency:                      day
    institute_id:                   UQAM
    rcm_version_id:                 v1
    project_id:                     CORDEX
    CORDEX_domain:                  NAM-44
    product:                        output
    references:                     http://www.mrcc.uqam.ca
    history:                        Fri Mar 29 14:03:34 2019: ncrcat -O -o /g...
    NCO:                            netCDF Operators version 4.7.4 (http://nc...
    model_id:                       UQAM-CRCM5
    driving_experiment:             CCCma-CanESM2,historical,r1i1p1
    driving_model_id:               CCCma-CanESM2
    history_of_appended_files:      Wed Sep  5 00:03:57 2018: Appended file t...
    tracking_id:                    5718ce6b-2ffb-4efb-9b49-f123e4184106
    nco_openmp_thread_number:       1
    id:                             doi:10.5065/D6SJ1JCH
    title:                          NA-CORDEX Raw NAM-44i CRCM5-UQAM CanESM2 ...
    version:                        1.0</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-0060522a-1195-4257-b419-9c8994ee97d7' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-0060522a-1195-4257-b419-9c8994ee97d7' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span>bnds</span>: 2</li><li><span class='xr-has-index'>lat</span>: 8</li><li><span class='xr-has-index'>lon</span>: 16</li><li><span class='xr-has-index'>time</span>: 20440</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-ef54a774-c4e8-4c36-b4d8-4506f754e46a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ef54a774-c4e8-4c36-b4d8-4506f754e46a' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>1950-01-01 12:00:00 ... 2005-12-...</div><input id='attrs-5d4d6a89-b49e-4463-b0ec-34aa94ce0d56' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5d4d6a89-b49e-4463-b0ec-34aa94ce0d56' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-93b269cc-1980-4f9f-9829-6fe673d2b4c4' class='xr-var-data-in' type='checkbox'><label for='data-93b269cc-1980-4f9f-9829-6fe673d2b4c4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>actual_range :</span></dt><dd>[ 31.5 395.5]</dd><dt><span>coordinate_defines :</span></dt><dd>point</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>delta_t :</span></dt><dd>0000-00-01 00:00:00</dd><dt><span>axis :</span></dt><dd>T</dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([cftime.DatetimeNoLeap(1950, 1, 1, 12, 0, 0, 0),
       cftime.DatetimeNoLeap(1950, 1, 2, 12, 0, 0, 0),
       cftime.DatetimeNoLeap(1950, 1, 3, 12, 0, 0, 0), ...,
       cftime.DatetimeNoLeap(2005, 12, 29, 12, 0, 0, 0),
       cftime.DatetimeNoLeap(2005, 12, 30, 12, 0, 0, 0),
       cftime.DatetimeNoLeap(2005, 12, 31, 12, 0, 0, 0)], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>37.25 37.75 38.25 ... 40.25 40.75</div><input id='attrs-81cd1fb9-c7da-48c2-9113-653c7ab07e45' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-81cd1fb9-c7da-48c2-9113-653c7ab07e45' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8e3fb66a-6b37-45fc-9e35-4fc42231e090' class='xr-var-data-in' type='checkbox'><label for='data-8e3fb66a-6b37-45fc-9e35-4fc42231e090' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([37.25, 37.75, 38.25, 38.75, 39.25, 39.75, 40.25, 40.75])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-109.8 -109.2 ... -102.8 -102.2</div><input id='attrs-92ecdf65-814e-4864-85e1-4da8e5e1113e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-92ecdf65-814e-4864-85e1-4da8e5e1113e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3f3c3d7e-ef39-494a-aca0-5c75ef460822' class='xr-var-data-in' type='checkbox'><label for='data-3f3c3d7e-ef39-494a-aca0-5c75ef460822' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-109.75, -109.25, -108.75, -108.25, -107.75, -107.25, -106.75, -106.25,
       -105.75, -105.25, -104.75, -104.25, -103.75, -103.25, -102.75, -102.25])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-80756041-e915-42f0-87c1-1e046fb2cf45' class='xr-section-summary-in' type='checkbox'  checked><label for='section-80756041-e915-42f0-87c1-1e046fb2cf45' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>uas</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-4102dccc-37c7-4667-a9f2-b79b4c11b94a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4102dccc-37c7-4667-a9f2-b79b4c11b94a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e409f51d-9bff-4b6c-9b78-6bb39b25ed89' class='xr-var-data-in' type='checkbox'><label for='data-e409f51d-9bff-4b6c-9b78-6bb39b25ed89' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m s-1</dd><dt><span>standard_name :</span></dt><dd>eastward_wind</dd><dt><span>actual_range :</span></dt><dd>[-28.95829057  28.48435832]</dd><dt><span>grid_desc :</span></dt><dd>rotated_pole</dd><dt><span>long_name :</span></dt><dd>Eastward Near-Surface Wind</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd><dt><span>remap :</span></dt><dd>remapped via ESMF_regrid_with_weights: Higher-order Patch</dd></dl></div><div class='xr-var-data'><pre>[2616320 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time_bnds</span></div><div class='xr-var-dims'>(time, bnds)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-a3d55e3b-f7ce-479f-a6ea-23c5f6cc7e42' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a3d55e3b-f7ce-479f-a6ea-23c5f6cc7e42' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5be8937f-10b9-414f-9e18-be3c6f62a2cc' class='xr-var-data-in' type='checkbox'><label for='data-5be8937f-10b9-414f-9e18-be3c6f62a2cc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[cftime.DatetimeNoLeap(1950, 1, 1, 0, 0, 0, 0),
        cftime.DatetimeNoLeap(1950, 1, 2, 0, 0, 0, 0)],
       [cftime.DatetimeNoLeap(1950, 1, 2, 0, 0, 0, 0),
        cftime.DatetimeNoLeap(1950, 1, 3, 0, 0, 0, 0)],
       [cftime.DatetimeNoLeap(1950, 1, 3, 0, 0, 0, 0),
        cftime.DatetimeNoLeap(1950, 1, 4, 0, 0, 0, 0)],
       ...,
       [cftime.DatetimeNoLeap(2005, 12, 29, 0, 0, 0, 0),
        cftime.DatetimeNoLeap(2005, 12, 30, 0, 0, 0, 0)],
       [cftime.DatetimeNoLeap(2005, 12, 30, 0, 0, 0, 0),
        cftime.DatetimeNoLeap(2005, 12, 31, 0, 0, 0, 0)],
       [cftime.DatetimeNoLeap(2005, 12, 31, 0, 0, 0, 0),
        cftime.DatetimeNoLeap(2006, 1, 1, 0, 0, 0, 0)]], dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9a0644bc-5cad-4640-9596-527be5a2c44d' class='xr-section-summary-in' type='checkbox'  ><label for='section-9a0644bc-5cad-4640-9596-527be5a2c44d' class='xr-section-summary' >Attributes: <span>(32)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.4</dd><dt><span>institution :</span></dt><dd>Universite du Quebec a Montreal</dd><dt><span>contact :</span></dt><dd>Winger.Katja@uqam.ca</dd><dt><span>comment :</span></dt><dd>CORDEX North America CRCM5 v333 0.44 deg CCCMA-CanESM2 L56</dd><dt><span>model :</span></dt><dd>CRCM5 (dynamics GEM v_3.3.3, physics RPN 5.0.4)</dd><dt><span>model_grid :</span></dt><dd>rotated lat-lon 236x241 incl. 10p pilot and 10p blending</dd><dt><span>geophysical_fields :</span></dt><dd>orography: USGS / land use cover: USGS / sand &amp; clay: ECOCLIMAP</dd><dt><span>physics :</span></dt><dd>land: CLASS3.5+, 26L, bottom at 60m / lakes: FLake / precipitation: bourge3d / vertical diffusion: clef / shallow convection : conres &amp; ktrsnt / deep convection: Kain-Fritsch / radiation : cccmarad</dd><dt><span>forcing :</span></dt><dd>GHG: CO2,CH4,N2O,CFC11,effective CFC12</dd><dt><span>creation_date :</span></dt><dd>2012-09-06</dd><dt><span>experiment :</span></dt><dd>historical</dd><dt><span>experiment_id :</span></dt><dd>historical</dd><dt><span>driving_model_ensemble_member :</span></dt><dd>r1i1p1</dd><dt><span>driving_experiment_name :</span></dt><dd>historical</dd><dt><span>frequency :</span></dt><dd>day</dd><dt><span>institute_id :</span></dt><dd>UQAM</dd><dt><span>rcm_version_id :</span></dt><dd>v1</dd><dt><span>project_id :</span></dt><dd>CORDEX</dd><dt><span>CORDEX_domain :</span></dt><dd>NAM-44</dd><dt><span>product :</span></dt><dd>output</dd><dt><span>references :</span></dt><dd>http://www.mrcc.uqam.ca</dd><dt><span>history :</span></dt><dd>Fri Mar 29 14:03:34 2019: ncrcat -O -o /glade/collections/cdg/data/cordex/data2/raw/NAM-44i/day/CRCM5-UQAM/CanESM2/hist/uas/uas.hist.CanESM2.CRCM5-UQAM.day.NAM-44i.raw.nc -p /glade/collections/cdg/work/cordex/esgf/crcm5-uqam/canesm2/nam-44i/hist/day uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19500101-19501231.nc uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19510101-19551231.nc uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19560101-19601231.nc uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19610101-19651231.nc uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19660101-19701231.nc uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19710101-19751231.nc uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19760101-19801231.nc uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19810101-19851231.nc uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19860101-19901231.nc uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19910101-19951231.nc uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19960101-20001231.nc uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_20010101-20051231.nc
Wed Sep  5 00:03:57 2018: ncks -A time_bnds.nc uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19500101-19501231.nc
Wed Sep  5 00:03:57 2018: ncks -v time_bnds ../uas_NAM-44_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19500101-19501231.nc time_bnds.nc
Thu Sep  6 22:52:43 2012: ncks -a -x -v plev,lev -4 -L 1 uas_NAM-44_CCCMA-CanESM2_historical_r1i1p1_UQAM_CRCM_v1_day_19500101-19501231.nc /home/winger/work/CORDEX/NorthAmerica_0.44deg_CanHisto_B1/NetCDF/trav_1736/tmp_1736</dd><dt><span>NCO :</span></dt><dd>netCDF Operators version 4.7.4 (http://nco.sf.net)</dd><dt><span>model_id :</span></dt><dd>UQAM-CRCM5</dd><dt><span>driving_experiment :</span></dt><dd>CCCma-CanESM2,historical,r1i1p1</dd><dt><span>driving_model_id :</span></dt><dd>CCCma-CanESM2</dd><dt><span>history_of_appended_files :</span></dt><dd>Wed Sep  5 00:03:57 2018: Appended file time_bnds.nc had following &quot;history&quot; attribute:
Wed Sep  5 00:03:57 2018: ncks -v time_bnds ../uas_NAM-44_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19500101-19501231.nc time_bnds.nc
Thu Sep  6 22:52:43 2012: ncks -a -x -v plev,lev -4 -L 1 uas_NAM-44_CCCMA-CanESM2_historical_r1i1p1_UQAM_CRCM_v1_day_19500101-19501231.nc /home/winger/work/CORDEX/NorthAmerica_0.44deg_CanHisto_B1/NetCDF/trav_1736/tmp_1736
</dd><dt><span>tracking_id :</span></dt><dd>5718ce6b-2ffb-4efb-9b49-f123e4184106</dd><dt><span>nco_openmp_thread_number :</span></dt><dd>1</dd><dt><span>id :</span></dt><dd>doi:10.5065/D6SJ1JCH</dd><dt><span>title :</span></dt><dd>NA-CORDEX Raw NAM-44i CRCM5-UQAM CanESM2 Hist Daily Mean 10m Eastward Wind Velocity</dd><dt><span>version :</span></dt><dd>1.0</dd></dl></div></li></ul></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ds_hist</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;PRGn&quot;</span><span class="p">,</span> <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;m/s&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.contour.QuadContourSet at 0x7fd9670f05e0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../../../_images/repos_NCAR_notebook-gallery_notebooks_Run-Anywhere_Bias-Correction_bias_correction_7_1.png" src="../../../../../../_images/repos_NCAR_notebook-gallery_notebooks_Run-Anywhere_Bias-Correction_bias_correction_7_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ds_rcp85</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">rcp85_file</span><span class="p">)</span>
<span class="n">ds_rcp85</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:    (bnds: 2, lat: 8, lon: 16, time: 20440)
Coordinates:
  * time       (time) object 1950-01-01 12:00:00 ... 2005-12-31 12:00:00
  * lat        (lat) float64 37.25 37.75 38.25 38.75 39.25 39.75 40.25 40.75
  * lon        (lon) float64 -109.8 -109.2 -108.8 ... -103.2 -102.8 -102.2
Dimensions without coordinates: bnds
Data variables:
    uas        (time, lat, lon) float32 ...
    time_bnds  (time, bnds) object 1950-01-01 00:00:00 ... 2006-01-01 00:00:00
Attributes:
    Conventions:                    CF-1.4
    institution:                    Universite du Quebec a Montreal
    contact:                        Winger.Katja@uqam.ca
    comment:                        CORDEX North America CRCM5 v333 0.44 deg ...
    model:                          CRCM5 (dynamics GEM v_3.3.3, physics RPN ...
    model_grid:                     rotated lat-lon 236x241 incl. 10p pilot a...
    geophysical_fields:             orography: USGS / land use cover: USGS / ...
    physics:                        land: CLASS3.5+, 26L, bottom at 60m / lak...
    forcing:                        GHG: CO2,CH4,N2O,CFC11,effective CFC12
    creation_date:                  2012-09-06
    experiment:                     historical
    experiment_id:                  historical
    driving_model_ensemble_member:  r1i1p1
    driving_experiment_name:        historical
    frequency:                      day
    institute_id:                   UQAM
    rcm_version_id:                 v1
    project_id:                     CORDEX
    CORDEX_domain:                  NAM-44
    product:                        output
    references:                     http://www.mrcc.uqam.ca
    history:                        Fri Mar 29 14:03:34 2019: ncrcat -O -o /g...
    NCO:                            netCDF Operators version 4.7.4 (http://nc...
    model_id:                       UQAM-CRCM5
    driving_experiment:             CCCma-CanESM2,historical,r1i1p1
    driving_model_id:               CCCma-CanESM2
    history_of_appended_files:      Wed Sep  5 00:03:57 2018: Appended file t...
    tracking_id:                    5718ce6b-2ffb-4efb-9b49-f123e4184106
    nco_openmp_thread_number:       1
    id:                             doi:10.5065/D6SJ1JCH
    title:                          NA-CORDEX Raw NAM-44i CRCM5-UQAM CanESM2 ...
    version:                        1.0</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-88fcbd9a-291d-452b-bfee-416f64866c44' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-88fcbd9a-291d-452b-bfee-416f64866c44' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span>bnds</span>: 2</li><li><span class='xr-has-index'>lat</span>: 8</li><li><span class='xr-has-index'>lon</span>: 16</li><li><span class='xr-has-index'>time</span>: 20440</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-90a9d0d2-eaa5-42cb-ac25-70e21e07ee2d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-90a9d0d2-eaa5-42cb-ac25-70e21e07ee2d' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>1950-01-01 12:00:00 ... 2005-12-...</div><input id='attrs-dc60e461-b997-4707-a370-57ff6cf72bcd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-dc60e461-b997-4707-a370-57ff6cf72bcd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-606ad914-318a-41c5-a60e-8a9d93c7670d' class='xr-var-data-in' type='checkbox'><label for='data-606ad914-318a-41c5-a60e-8a9d93c7670d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>actual_range :</span></dt><dd>[ 31.5 395.5]</dd><dt><span>coordinate_defines :</span></dt><dd>point</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>delta_t :</span></dt><dd>0000-00-01 00:00:00</dd><dt><span>axis :</span></dt><dd>T</dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([cftime.DatetimeNoLeap(1950, 1, 1, 12, 0, 0, 0),
       cftime.DatetimeNoLeap(1950, 1, 2, 12, 0, 0, 0),
       cftime.DatetimeNoLeap(1950, 1, 3, 12, 0, 0, 0), ...,
       cftime.DatetimeNoLeap(2005, 12, 29, 12, 0, 0, 0),
       cftime.DatetimeNoLeap(2005, 12, 30, 12, 0, 0, 0),
       cftime.DatetimeNoLeap(2005, 12, 31, 12, 0, 0, 0)], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>37.25 37.75 38.25 ... 40.25 40.75</div><input id='attrs-61a2d0d2-ea2d-4be2-86e3-6fcb2377bb5f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-61a2d0d2-ea2d-4be2-86e3-6fcb2377bb5f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-27ad017f-0488-4363-a198-88d21164ba3d' class='xr-var-data-in' type='checkbox'><label for='data-27ad017f-0488-4363-a198-88d21164ba3d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([37.25, 37.75, 38.25, 38.75, 39.25, 39.75, 40.25, 40.75])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-109.8 -109.2 ... -102.8 -102.2</div><input id='attrs-85be733e-4bd4-4c24-adda-c502c1662753' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-85be733e-4bd4-4c24-adda-c502c1662753' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-28ac094a-7422-4a5a-a5a4-08ad2451fd8b' class='xr-var-data-in' type='checkbox'><label for='data-28ac094a-7422-4a5a-a5a4-08ad2451fd8b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-109.75, -109.25, -108.75, -108.25, -107.75, -107.25, -106.75, -106.25,
       -105.75, -105.25, -104.75, -104.25, -103.75, -103.25, -102.75, -102.25])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d7484ee3-b840-4604-a56d-620bbc11bb49' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d7484ee3-b840-4604-a56d-620bbc11bb49' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>uas</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-6382a9db-af15-44da-a301-d23768b5bb7c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6382a9db-af15-44da-a301-d23768b5bb7c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e8df7ab5-2ed2-4115-81a9-0b19f5aeebe5' class='xr-var-data-in' type='checkbox'><label for='data-e8df7ab5-2ed2-4115-81a9-0b19f5aeebe5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m s-1</dd><dt><span>standard_name :</span></dt><dd>eastward_wind</dd><dt><span>actual_range :</span></dt><dd>[-28.95829057  28.48435832]</dd><dt><span>grid_desc :</span></dt><dd>rotated_pole</dd><dt><span>long_name :</span></dt><dd>Eastward Near-Surface Wind</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd><dt><span>remap :</span></dt><dd>remapped via ESMF_regrid_with_weights: Higher-order Patch</dd></dl></div><div class='xr-var-data'><pre>[2616320 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time_bnds</span></div><div class='xr-var-dims'>(time, bnds)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-a374733d-51ab-44e5-a083-4abc8726b656' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a374733d-51ab-44e5-a083-4abc8726b656' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a635a613-5f87-406e-bbb8-9d1e0effd879' class='xr-var-data-in' type='checkbox'><label for='data-a635a613-5f87-406e-bbb8-9d1e0effd879' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[cftime.DatetimeNoLeap(1950, 1, 1, 0, 0, 0, 0),
        cftime.DatetimeNoLeap(1950, 1, 2, 0, 0, 0, 0)],
       [cftime.DatetimeNoLeap(1950, 1, 2, 0, 0, 0, 0),
        cftime.DatetimeNoLeap(1950, 1, 3, 0, 0, 0, 0)],
       [cftime.DatetimeNoLeap(1950, 1, 3, 0, 0, 0, 0),
        cftime.DatetimeNoLeap(1950, 1, 4, 0, 0, 0, 0)],
       ...,
       [cftime.DatetimeNoLeap(2005, 12, 29, 0, 0, 0, 0),
        cftime.DatetimeNoLeap(2005, 12, 30, 0, 0, 0, 0)],
       [cftime.DatetimeNoLeap(2005, 12, 30, 0, 0, 0, 0),
        cftime.DatetimeNoLeap(2005, 12, 31, 0, 0, 0, 0)],
       [cftime.DatetimeNoLeap(2005, 12, 31, 0, 0, 0, 0),
        cftime.DatetimeNoLeap(2006, 1, 1, 0, 0, 0, 0)]], dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f731d2bc-d172-4b08-b63b-c080f15906ad' class='xr-section-summary-in' type='checkbox'  ><label for='section-f731d2bc-d172-4b08-b63b-c080f15906ad' class='xr-section-summary' >Attributes: <span>(32)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.4</dd><dt><span>institution :</span></dt><dd>Universite du Quebec a Montreal</dd><dt><span>contact :</span></dt><dd>Winger.Katja@uqam.ca</dd><dt><span>comment :</span></dt><dd>CORDEX North America CRCM5 v333 0.44 deg CCCMA-CanESM2 L56</dd><dt><span>model :</span></dt><dd>CRCM5 (dynamics GEM v_3.3.3, physics RPN 5.0.4)</dd><dt><span>model_grid :</span></dt><dd>rotated lat-lon 236x241 incl. 10p pilot and 10p blending</dd><dt><span>geophysical_fields :</span></dt><dd>orography: USGS / land use cover: USGS / sand &amp; clay: ECOCLIMAP</dd><dt><span>physics :</span></dt><dd>land: CLASS3.5+, 26L, bottom at 60m / lakes: FLake / precipitation: bourge3d / vertical diffusion: clef / shallow convection : conres &amp; ktrsnt / deep convection: Kain-Fritsch / radiation : cccmarad</dd><dt><span>forcing :</span></dt><dd>GHG: CO2,CH4,N2O,CFC11,effective CFC12</dd><dt><span>creation_date :</span></dt><dd>2012-09-06</dd><dt><span>experiment :</span></dt><dd>historical</dd><dt><span>experiment_id :</span></dt><dd>historical</dd><dt><span>driving_model_ensemble_member :</span></dt><dd>r1i1p1</dd><dt><span>driving_experiment_name :</span></dt><dd>historical</dd><dt><span>frequency :</span></dt><dd>day</dd><dt><span>institute_id :</span></dt><dd>UQAM</dd><dt><span>rcm_version_id :</span></dt><dd>v1</dd><dt><span>project_id :</span></dt><dd>CORDEX</dd><dt><span>CORDEX_domain :</span></dt><dd>NAM-44</dd><dt><span>product :</span></dt><dd>output</dd><dt><span>references :</span></dt><dd>http://www.mrcc.uqam.ca</dd><dt><span>history :</span></dt><dd>Fri Mar 29 14:03:34 2019: ncrcat -O -o /glade/collections/cdg/data/cordex/data2/raw/NAM-44i/day/CRCM5-UQAM/CanESM2/hist/uas/uas.hist.CanESM2.CRCM5-UQAM.day.NAM-44i.raw.nc -p /glade/collections/cdg/work/cordex/esgf/crcm5-uqam/canesm2/nam-44i/hist/day uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19500101-19501231.nc uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19510101-19551231.nc uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19560101-19601231.nc uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19610101-19651231.nc uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19660101-19701231.nc uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19710101-19751231.nc uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19760101-19801231.nc uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19810101-19851231.nc uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19860101-19901231.nc uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19910101-19951231.nc uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19960101-20001231.nc uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_20010101-20051231.nc
Wed Sep  5 00:03:57 2018: ncks -A time_bnds.nc uas_NAM-44i_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19500101-19501231.nc
Wed Sep  5 00:03:57 2018: ncks -v time_bnds ../uas_NAM-44_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19500101-19501231.nc time_bnds.nc
Thu Sep  6 22:52:43 2012: ncks -a -x -v plev,lev -4 -L 1 uas_NAM-44_CCCMA-CanESM2_historical_r1i1p1_UQAM_CRCM_v1_day_19500101-19501231.nc /home/winger/work/CORDEX/NorthAmerica_0.44deg_CanHisto_B1/NetCDF/trav_1736/tmp_1736</dd><dt><span>NCO :</span></dt><dd>netCDF Operators version 4.7.4 (http://nco.sf.net)</dd><dt><span>model_id :</span></dt><dd>UQAM-CRCM5</dd><dt><span>driving_experiment :</span></dt><dd>CCCma-CanESM2,historical,r1i1p1</dd><dt><span>driving_model_id :</span></dt><dd>CCCma-CanESM2</dd><dt><span>history_of_appended_files :</span></dt><dd>Wed Sep  5 00:03:57 2018: Appended file time_bnds.nc had following &quot;history&quot; attribute:
Wed Sep  5 00:03:57 2018: ncks -v time_bnds ../uas_NAM-44_CCCma-CanESM2_historical_r1i1p1_UQAM-CRCM5_v1_day_19500101-19501231.nc time_bnds.nc
Thu Sep  6 22:52:43 2012: ncks -a -x -v plev,lev -4 -L 1 uas_NAM-44_CCCMA-CanESM2_historical_r1i1p1_UQAM_CRCM_v1_day_19500101-19501231.nc /home/winger/work/CORDEX/NorthAmerica_0.44deg_CanHisto_B1/NetCDF/trav_1736/tmp_1736
</dd><dt><span>tracking_id :</span></dt><dd>5718ce6b-2ffb-4efb-9b49-f123e4184106</dd><dt><span>nco_openmp_thread_number :</span></dt><dd>1</dd><dt><span>id :</span></dt><dd>doi:10.5065/D6SJ1JCH</dd><dt><span>title :</span></dt><dd>NA-CORDEX Raw NAM-44i CRCM5-UQAM CanESM2 Hist Daily Mean 10m Eastward Wind Velocity</dd><dt><span>version :</span></dt><dd>1.0</dd></dl></div></li></ul></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ds_rcp85</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;PRGn&quot;</span><span class="p">,</span> <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;m/s&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.contour.QuadContourSet at 0x7fd966700370&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../../../_images/repos_NCAR_notebook-gallery_notebooks_Run-Anywhere_Bias-Correction_bias_correction_9_1.png" src="../../../../../../_images/repos_NCAR_notebook-gallery_notebooks_Run-Anywhere_Bias-Correction_bias_correction_9_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ds_meas</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">meas_file</span><span class="p">)</span>
<span class="n">ds_meas</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:      (bnds: 2, lat: 8, lon: 16, time: 13880)
Coordinates:
  * time         (time) datetime64[ns] 1979-01-01T19:00:00 ... 2016-12-31T19:...
  * lon          (lon) float64 -109.8 -109.2 -108.8 ... -103.2 -102.8 -102.2
  * lat          (lat) float64 37.25 37.75 38.25 38.75 39.25 39.75 40.25 40.75
Dimensions without coordinates: bnds
Data variables:
    uas          (time, lat, lon) float32 ...
    time_bnds    (time, bnds) datetime64[ns] 1979-01-01T07:00:00 ... 2017-01-...
    data_status  (time) int8 2 2 2 2 2 2 2 2 2 2 2 2 ... 0 0 0 0 0 0 0 0 0 0 0 0
    lon_bnds     (lon, bnds) float32 -110.0 -109.5 -109.5 ... -102.5 -102.0
    lat_bnds     (lat, bnds) float32 37.0 37.5 37.5 38.0 ... 40.0 40.5 40.5 41.0
    crs          int32 1
Attributes:
    author:                    John Abatzoglou - University of Idaho, jabatzo...
    creation_date:             10 March 2016
    Conventions:               CF-1.6
    title:                     gridMET gridded surface meteorological data
    institution:               University of Idaho
    contact:                   John Abatzoglou, jabatzoglou@uidaho.edu
    URL:                       http://www.climatologylab.org/gridmet.html
    references:                Abatzoglou, J.T., 2012, Development of gridded...
    source:                    gridMET combines data from PRISM and NLDAS-2 a...
    acknowledgements:          CF compliance by Seth McGinnis, mcginnis@ucar.edu
    uuid:                      82c7e638-7fb7-4a0d-bcef-c2d18a69f8fa
    history:                   Fri Aug 30 15:00:15 2019: ncrcat -n 38,4,1 uas...
    NCO:                       netCDF Operators version 4.7.4 (http://nco.sf....
    tracking_id:               da9158a7-73d3-4e74-aeaf-c0f7d0433508
    nco_openmp_thread_number:  1</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-27e27463-e0b5-4ed6-98cc-3bba7de5e373' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-27e27463-e0b5-4ed6-98cc-3bba7de5e373' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span>bnds</span>: 2</li><li><span class='xr-has-index'>lat</span>: 8</li><li><span class='xr-has-index'>lon</span>: 16</li><li><span class='xr-has-index'>time</span>: 13880</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-aeb91ae2-5a9c-4be1-8c99-3cefbbdfd529' class='xr-section-summary-in' type='checkbox'  checked><label for='section-aeb91ae2-5a9c-4be1-8c99-3cefbbdfd529' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1979-01-01T19:00:00 ... 2016-12-...</div><input id='attrs-ec6e6eab-52e7-48bd-aa59-ba9eeffb53d2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ec6e6eab-52e7-48bd-aa59-ba9eeffb53d2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-41eabe25-518b-4628-9fdc-911122803956' class='xr-var-data-in' type='checkbox'><label for='data-41eabe25-518b-4628-9fdc-911122803956' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>note :</span></dt><dd>Days start/end at approximately midnight Mountain Standard Time</dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>time</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1979-01-01T19:00:00.000000000&#x27;, &#x27;1979-01-02T19:00:00.000000000&#x27;,
       &#x27;1979-01-03T19:00:00.000000000&#x27;, ..., &#x27;2016-12-29T19:00:00.000000000&#x27;,
       &#x27;2016-12-30T19:00:00.000000000&#x27;, &#x27;2016-12-31T19:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-109.8 -109.2 ... -102.8 -102.2</div><input id='attrs-7709316b-1ee7-4295-afe0-e1dae6f2a619' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7709316b-1ee7-4295-afe0-e1dae6f2a619' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b3f677da-f8b6-442a-b118-829bcd0de438' class='xr-var-data-in' type='checkbox'><label for='data-b3f677da-f8b6-442a-b118-829bcd0de438' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>bounds :</span></dt><dd>lon_bnds</dd></dl></div><div class='xr-var-data'><pre>array([-109.75, -109.25, -108.75, -108.25, -107.75, -107.25, -106.75, -106.25,
       -105.75, -105.25, -104.75, -104.25, -103.75, -103.25, -102.75, -102.25])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>37.25 37.75 38.25 ... 40.25 40.75</div><input id='attrs-72339913-ff9b-48e9-93b5-71756cc1e6d3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-72339913-ff9b-48e9-93b5-71756cc1e6d3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-704bdfc9-05ed-4b7e-a21e-ea07ad9006df' class='xr-var-data-in' type='checkbox'><label for='data-704bdfc9-05ed-4b7e-a21e-ea07ad9006df' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>bounds :</span></dt><dd>lat_bnds</dd></dl></div><div class='xr-var-data'><pre>array([37.25, 37.75, 38.25, 38.75, 39.25, 39.75, 40.25, 40.75])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-51dc4f89-8221-4505-a516-cec00eeb58d9' class='xr-section-summary-in' type='checkbox'  checked><label for='section-51dc4f89-8221-4505-a516-cec00eeb58d9' class='xr-section-summary' >Data variables: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>uas</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-a9ec3359-de66-4a6d-9a82-51faaebee678' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a9ec3359-de66-4a6d-9a82-51faaebee678' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-52062132-1cb7-4bda-9ef9-5808b4c8fb7b' class='xr-var-data-in' type='checkbox'><label for='data-52062132-1cb7-4bda-9ef9-5808b4c8fb7b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>missing_threshold :</span></dt><dd>50%</dd><dt><span>cell_methods :</span></dt><dd>time: mean(interval: 24 hours)</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>height :</span></dt><dd>10 m</dd><dt><span>units :</span></dt><dd>m/s</dd><dt><span>standard_name :</span></dt><dd>eastward_wind</dd><dt><span>long_name :</span></dt><dd>Eastward Surface Wind Speed</dd></dl></div><div class='xr-var-data'><pre>[1776640 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time_bnds</span></div><div class='xr-var-dims'>(time, bnds)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-01bff45b-d039-49ef-9ce9-13da3c262aeb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-01bff45b-d039-49ef-9ce9-13da3c262aeb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f30d1e1b-2a64-484f-a164-bea0be11a972' class='xr-var-data-in' type='checkbox'><label for='data-f30d1e1b-2a64-484f-a164-bea0be11a972' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[&#x27;1979-01-01T07:00:00.000000000&#x27;, &#x27;1979-01-02T07:00:00.000000000&#x27;],
       [&#x27;1979-01-02T07:00:00.000000000&#x27;, &#x27;1979-01-03T07:00:00.000000000&#x27;],
       [&#x27;1979-01-03T07:00:00.000000000&#x27;, &#x27;1979-01-04T07:00:00.000000000&#x27;],
       ...,
       [&#x27;2016-12-29T07:00:00.000000000&#x27;, &#x27;2016-12-30T07:00:00.000000000&#x27;],
       [&#x27;2016-12-30T07:00:00.000000000&#x27;, &#x27;2016-12-31T07:00:00.000000000&#x27;],
       [&#x27;2016-12-31T07:00:00.000000000&#x27;, &#x27;2017-01-01T07:00:00.000000000&#x27;]],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>data_status</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int8</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-a21ef668-0a75-4077-a82d-40869a264802' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a21ef668-0a75-4077-a82d-40869a264802' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cee2f773-5d03-4f42-ba8d-7012047795dc' class='xr-var-data-in' type='checkbox'><label for='data-cee2f773-5d03-4f42-ba8d-7012047795dc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>flag_meanings :</span></dt><dd>permanent provisional early</dd><dt><span>flag_values :</span></dt><dd>[0 1 2]</dd></dl></div><div class='xr-var-data'><pre>array([2, 2, 2, ..., 0, 0, 0], dtype=int8)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon_bnds</span></div><div class='xr-var-dims'>(lon, bnds)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-d255cd8d-7c84-4946-873e-7b1c6e37d0c0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d255cd8d-7c84-4946-873e-7b1c6e37d0c0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-769eb165-4ddf-4177-8e10-d69ebc62cff6' class='xr-var-data-in' type='checkbox'><label for='data-769eb165-4ddf-4177-8e10-d69ebc62cff6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[-110. , -109.5],
       [-109.5, -109. ],
       [-109. , -108.5],
       [-108.5, -108. ],
       [-108. , -107.5],
       [-107.5, -107. ],
       [-107. , -106.5],
       [-106.5, -106. ],
       [-106. , -105.5],
       [-105.5, -105. ],
       [-105. , -104.5],
       [-104.5, -104. ],
       [-104. , -103.5],
       [-103.5, -103. ],
       [-103. , -102.5],
       [-102.5, -102. ]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat_bnds</span></div><div class='xr-var-dims'>(lat, bnds)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-61128ecf-c1d3-46b1-8958-9dbba55f210f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-61128ecf-c1d3-46b1-8958-9dbba55f210f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eef968b2-9877-46aa-a38c-18953498b17e' class='xr-var-data-in' type='checkbox'><label for='data-eef968b2-9877-46aa-a38c-18953498b17e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[37. , 37.5],
       [37.5, 38. ],
       [38. , 38.5],
       [38.5, 39. ],
       [39. , 39.5],
       [39.5, 40. ],
       [40. , 40.5],
       [40.5, 41. ]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>crs</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-65b67938-5e08-4d2a-86f8-4176e33b38f1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-65b67938-5e08-4d2a-86f8-4176e33b38f1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2def2411-6838-47f6-ba27-b5cc840835e8' class='xr-var-data-in' type='checkbox'><label for='data-2def2411-6838-47f6-ba27-b5cc840835e8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping_name :</span></dt><dd>latitude_longitude</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>crs_wkt :</span></dt><dd>GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</dd><dt><span>long_name :</span></dt><dd>WGS 84</dd></dl></div><div class='xr-var-data'><pre>array(1, dtype=int32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2dff43c5-6e85-47b4-a76e-091d4d8634d8' class='xr-section-summary-in' type='checkbox'  ><label for='section-2dff43c5-6e85-47b4-a76e-091d4d8634d8' class='xr-section-summary' >Attributes: <span>(15)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>author :</span></dt><dd>John Abatzoglou - University of Idaho, jabatzoglou@uidaho.edu</dd><dt><span>creation_date :</span></dt><dd>10 March 2016</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>title :</span></dt><dd>gridMET gridded surface meteorological data</dd><dt><span>institution :</span></dt><dd>University of Idaho</dd><dt><span>contact :</span></dt><dd>John Abatzoglou, jabatzoglou@uidaho.edu</dd><dt><span>URL :</span></dt><dd>http://www.climatologylab.org/gridmet.html</dd><dt><span>references :</span></dt><dd>Abatzoglou, J.T., 2012, Development of gridded surface meteorological data for ecological applications and modeling, International Journal of Climatology, DOI: 10.1002/joc.3413</dd><dt><span>source :</span></dt><dd>gridMET combines data from PRISM and NLDAS-2 according to the method of Abatzoglou 2012; PRISM v.LT71m: PRISM Climate Group, Oregon State University, http://prism.oregonstate.edu; NLDAS-2 v.s4pa: NASA ESD, Goddard Earth Sciences, http://ldas.gsfc.nasa.gov/nldas/</dd><dt><span>acknowledgements :</span></dt><dd>CF compliance by Seth McGinnis, mcginnis@ucar.edu</dd><dt><span>uuid :</span></dt><dd>82c7e638-7fb7-4a0d-bcef-c2d18a69f8fa</dd><dt><span>history :</span></dt><dd>Fri Aug 30 15:00:15 2019: ncrcat -n 38,4,1 uas.44i.1979.nc common/uas.gridMET.NAM-44i.nc
Thu Aug 29 19:19:35 MDT 2019: ncl coarsen.ncl datafile=uas.1979.nc gridfile=grid/grid.NAM-44i.nc outfile=regrid/uas.44i.1979.nc
Wed Aug 28 19:26:43 2019: ncatted -a long_name,uas,o,c,Eastward Surface Wind Speed uas.1979.nc
Wed Aug 28 19:26:43 2019: ncatted -a standard_name,uas,o,c,eastward_wind uas.1979.nc
Wed Aug 28 19:24:26 2019: ncks -x -v spd,dir,vas wind.1979.nc uas.1979.nc
Wed Aug 28 19:23:08 2019: ncap2 -A -s vas=spd*sin((270-dir)*atan(1)/45); wind.1979.nc wind.1979.nc
Wed Aug 28 19:21:48 2019: ncap2 -A -s uas=spd*cos((270-dir)*atan(1)/45); wind.1979.nc wind.1979.nc
Wed Aug 28 19:21:19 2019: ncks -A dir.1979.nc wind.1979.nc
Wed Aug 28 18:42:26 MDT 2019: updated for CF-compliance</dd><dt><span>NCO :</span></dt><dd>netCDF Operators version 4.7.4 (http://nco.sf.net)</dd><dt><span>tracking_id :</span></dt><dd>da9158a7-73d3-4e74-aeaf-c0f7d0433508</dd><dt><span>nco_openmp_thread_number :</span></dt><dd>1</dd></dl></div></li></ul></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ds_meas</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;PRGn&quot;</span><span class="p">,</span> <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;m/s&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.contour.QuadContourSet at 0x7fd9667492b0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../../../_images/repos_NCAR_notebook-gallery_notebooks_Run-Anywhere_Bias-Correction_bias_correction_11_1.png" src="../../../../../../_images/repos_NCAR_notebook-gallery_notebooks_Run-Anywhere_Bias-Correction_bias_correction_11_1.png" />
</div>
</div>
</div>
<div class="section" id="2.-Filter-Data">
<h2>2. Filter Data<a class="headerlink" href="#2.-Filter-Data" title="Permalink to this headline">¶</a></h2>
<p>We limit the extent of our data to the state of Colorado simply to speed up our calculations in this example.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wesn</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">110</span><span class="p">,</span> <span class="o">-</span><span class="mi">108</span><span class="p">,</span> <span class="mf">39.5</span><span class="p">,</span> <span class="mf">41.5</span><span class="p">]</span>
<span class="n">ds_meas_flt</span> <span class="o">=</span> <span class="n">ds_meas</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lon</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">wesn</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wesn</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">wesn</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">wesn</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
<span class="n">ds_hist_flt</span> <span class="o">=</span> <span class="n">ds_hist</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lon</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">wesn</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wesn</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">wesn</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">wesn</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
<span class="n">ds_rcp85_flt</span> <span class="o">=</span> <span class="n">ds_rcp85</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lon</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">wesn</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wesn</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">wesn</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">wesn</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="3.-Align-Time">
<h2>3. Align Time<a class="headerlink" href="#3.-Align-Time" title="Permalink to this headline">¶</a></h2>
<p>Our two modeled datasets do not have leap years, where our measured dataset does.</p>
<p>There are several methods of dealing with leap years that are better for different types of data. For data that is continuous, such as wind speed, we can simply drop all December 31st from leap years (any time there is a 366th day to the year we drop day #366). This method would not be ideal for discontinous data such as precipitation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ds_meas_noleap</span> <span class="o">=</span> <span class="n">ds_meas_flt</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=~</span><span class="p">((</span><span class="n">ds_meas_flt</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofyear</span> <span class="o">==</span> <span class="mi">366</span><span class="p">)</span> <span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">_cfnoleap_to_datetime</span><span class="p">(</span><span class="n">da</span><span class="p">):</span>
    <span class="n">datetimeindex</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_datetimeindex</span><span class="p">()</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">da</span><span class="c1">#.to_dataset()</span>
    <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;time_dt&#39;</span><span class="p">]</span><span class="o">=</span> <span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">datetimeindex</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">({</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;time_dt&#39;</span><span class="p">})</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">time</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">time_dt</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds</span>

<span class="n">ds_hist_dt</span> <span class="o">=</span> <span class="n">_cfnoleap_to_datetime</span><span class="p">(</span><span class="n">ds_hist_flt</span><span class="p">)</span>
<span class="n">ds_rcp85_dt</span> <span class="o">=</span> <span class="n">_cfnoleap_to_datetime</span><span class="p">(</span><span class="n">ds_rcp85_flt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
&lt;ipython-input-1-d460699fd441&gt;:2: RuntimeWarning: Converting a CFTimeIndex with dates from a non-standard calendar, &#39;noleap&#39;, to a pandas.DatetimeIndex, which uses dates from the standard calendar.  This may lead to subtle errors in operations that depend on the length of time between dates.
  datetimeindex = da.indexes[&#39;time&#39;].to_datetimeindex()
</pre></div></div>
</div>
<p>We also regroup our models so that the dates of the historical model line up with our historical measurements.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">_regroup_models_bytime</span><span class="p">(</span><span class="n">ds_meas</span><span class="p">,</span> <span class="n">ds_hist_dt</span><span class="p">,</span> <span class="n">ds_rcp_dt</span><span class="p">):</span>
    <span class="n">t0_meas</span> <span class="o">=</span> <span class="n">ds_meas</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">tn_meas</span> <span class="o">=</span> <span class="n">ds_meas</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">t0_fut</span> <span class="o">=</span> <span class="n">tn_meas</span><span class="o">.</span><span class="n">values</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>

    <span class="n">ds_past</span> <span class="o">=</span> <span class="n">ds_hist_dt</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time_dt</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">t0_meas</span><span class="p">,</span> <span class="n">tn_meas</span><span class="p">))</span>
    <span class="n">ds_past</span> <span class="o">=</span> <span class="n">ds_past</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">({</span><span class="s1">&#39;time_dt&#39;</span><span class="p">:</span><span class="s1">&#39;time&#39;</span><span class="p">})</span>

    <span class="n">ds_fut_pt1</span> <span class="o">=</span> <span class="n">ds_hist_dt</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time_dt</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">t0_fut</span><span class="p">,</span><span class="kc">None</span><span class="p">))</span>
    <span class="n">ds_fut</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">ds_fut_pt1</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">ds_rcp_dt</span><span class="p">[</span><span class="n">var</span><span class="p">]],</span> <span class="s1">&#39;time_dt&#39;</span><span class="p">)</span>
    <span class="n">ds_fut</span> <span class="o">=</span> <span class="n">ds_fut</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">({</span><span class="s1">&#39;time_dt&#39;</span><span class="p">:</span><span class="s1">&#39;time&#39;</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">ds_past</span><span class="p">,</span> <span class="n">ds_fut</span>

<span class="n">ds_past</span><span class="p">,</span> <span class="n">ds_fut</span> <span class="o">=</span> <span class="n">_regroup_models_bytime</span><span class="p">(</span><span class="n">ds_meas_noleap</span><span class="p">,</span> <span class="n">ds_hist_dt</span><span class="p">,</span> <span class="n">ds_rcp85_dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="4.-Z-score-Bias-Correction">
<h2>4. Z-score Bias Correction<a class="headerlink" href="#4.-Z-score-Bias-Correction" title="Permalink to this headline">¶</a></h2>
<p>Z-Score bias correction is a good technique for target variables with Gaussian probability distributions, such as zonal wind speed.</p>
<p>In essence the technique:</p>
<ol class="arabic">
<li><div class="line-block">
<div class="line">Finds the mean</div>
<div class="line"><br /></div>
</div>
<blockquote>
<div><div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\overline{x} = \sum_{i=0}^N \frac{x_i}{N}\\and standard deviation\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\sigma = \sqrt{\frac{\sum_{i=0}^N |x_i - \overline{x}|^2}{N-1}}\\of target (measured) data and training (historical modeled) data.\end{aligned}\end{align} \]</div>
</div></blockquote>
</li>
<li><p>Compares the difference between the statistical values to produce a shift</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}shift = \overline{x_{target}} - \overline{x_{training}}\\and scale parameter\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight">
\[scale = \sigma_{target} \div \sigma_{training}\]</div>
</li>
<li><p>Applies these paramaters to the future model data to be corrected to get a new mean</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\overline{x_{corrected}} = \overline{x_{future}} + shift\\and new standard deviation\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight">
\[\sigma_{corrected} = \sigma_{future} \times scale\]</div>
</li>
<li><p>Calculates the corrected values</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}x_{corrected_{i}} = z_i \times \sigma_{corrected} + \overline{x_{corrected}}\\from the future model's z-score values\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight">
\[z_i = \frac{x_i-\overline{x}}{\sigma}\]</div>
</li>
</ol>
<p>In practice, if the wind was on average 3 m/s faster on the first of July in the models compared to the measurements, we would adjust the modeled data for all July 1sts in the future modeled dataset to be 3 m/s faster. And similarly for scaling the standard deviation</p>
<p>Bias correction methods other than zscore include:</p>
<ul class="simple">
<li><p>scale (for wind speed, wave flux in air)</p></li>
<li><p>log (for precipitation)</p></li>
<li><p>range (relative humidity)</p></li>
<li><p>seth mcginnes’s kddm (for any bimodal distributions)</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">_reshape</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">window_width</span><span class="p">):</span>
    <span class="n">split</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;day&#39;</span><span class="p">})</span>
                       <span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">day</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofyear</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
    <span class="n">ds2</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">split</span><span class="p">)</span>

    <span class="n">early_Jans</span> <span class="o">=</span> <span class="n">ds2</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">day</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="n">window_width</span><span class="o">//</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">late_Decs</span> <span class="o">=</span> <span class="n">ds2</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">day</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="n">window_width</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span><span class="kc">None</span><span class="p">))</span>

    <span class="n">ds3</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">late_Decs</span><span class="p">,</span><span class="n">ds2</span><span class="p">,</span><span class="n">early_Jans</span><span class="p">],</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;day&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds3</span>

<span class="k">def</span> <span class="nf">_calc_stats</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">window_width</span><span class="p">):</span>
    <span class="n">ds_rsh</span> <span class="o">=</span> <span class="n">_reshape</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">window_width</span><span class="p">)</span>

    <span class="n">ds_rolled</span> <span class="o">=</span> <span class="n">ds_rsh</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">day</span><span class="o">=</span><span class="n">window_width</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;win_day&#39;</span><span class="p">)</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">window_width</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span>
    <span class="n">ds_mean</span> <span class="o">=</span> <span class="n">ds_rolled</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;win_day&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">day</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="o">-</span><span class="n">n</span><span class="p">))</span>
    <span class="n">ds_std</span> <span class="o">=</span> <span class="n">ds_rolled</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;win_day&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">day</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="o">-</span><span class="n">n</span><span class="p">))</span>

    <span class="n">ds_avyear</span> <span class="o">=</span> <span class="n">ds_rsh</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;day&#39;</span><span class="p">])</span>
    <span class="n">ds_zscore</span> <span class="o">=</span> <span class="p">((</span><span class="n">ds_avyear</span> <span class="o">-</span> <span class="n">ds_mean</span><span class="p">)</span> <span class="o">/</span> <span class="n">ds_std</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds_mean</span><span class="p">,</span> <span class="n">ds_std</span><span class="p">,</span> <span class="n">ds_zscore</span>

<span class="n">window_width</span><span class="o">=</span><span class="mi">31</span>
<span class="n">meas_mean</span><span class="p">,</span> <span class="n">meas_std</span><span class="p">,</span> <span class="n">meas_zscore</span> <span class="o">=</span> <span class="n">_calc_stats</span><span class="p">(</span><span class="n">ds_meas_noleap</span><span class="p">,</span> <span class="n">window_width</span><span class="p">)</span>
<span class="n">hist_mean</span><span class="p">,</span> <span class="n">hist_std</span><span class="p">,</span> <span class="n">hist_zscore</span> <span class="o">=</span> <span class="n">_calc_stats</span><span class="p">(</span><span class="n">ds_past</span><span class="p">,</span> <span class="n">window_width</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">_get_params</span><span class="p">(</span><span class="n">meas_mean</span><span class="p">,</span> <span class="n">meas_std</span><span class="p">,</span> <span class="n">past_mean</span><span class="p">,</span> <span class="n">past_std</span><span class="p">):</span>
    <span class="n">shift</span> <span class="o">=</span> <span class="n">meas_mean</span> <span class="o">-</span> <span class="n">past_mean</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">meas_std</span> <span class="o">/</span> <span class="n">past_std</span>
    <span class="k">return</span> <span class="n">shift</span><span class="p">,</span> <span class="n">scale</span>

<span class="n">shift</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">_get_params</span><span class="p">(</span><span class="n">meas_mean</span><span class="p">,</span> <span class="n">meas_std</span><span class="p">,</span> <span class="n">hist_mean</span><span class="p">,</span> <span class="n">hist_std</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">_calc_fut_stats</span><span class="p">(</span><span class="n">ds_fut</span><span class="p">,</span> <span class="n">window_width</span><span class="p">):</span>
    <span class="n">ds_rolled</span> <span class="o">=</span> <span class="n">ds_fut</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">window_width</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s1">&#39;win_day&#39;</span><span class="p">)</span>

    <span class="n">ds_mean</span> <span class="o">=</span> <span class="n">ds_rolled</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;win_day&#39;</span><span class="p">])</span>
    <span class="n">ds_std</span> <span class="o">=</span> <span class="n">ds_rolled</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;win_day&#39;</span><span class="p">])</span>

    <span class="n">ds_avyear</span> <span class="o">=</span> <span class="n">ds_fut</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span>
    <span class="n">ds_zscore</span> <span class="o">=</span> <span class="p">((</span><span class="n">ds_avyear</span> <span class="o">-</span> <span class="n">ds_mean</span><span class="p">)</span> <span class="o">/</span> <span class="n">ds_std</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds_mean</span><span class="p">,</span> <span class="n">ds_std</span><span class="p">,</span> <span class="n">ds_zscore</span>

<span class="n">fut_mean</span><span class="p">,</span> <span class="n">fut_std</span><span class="p">,</span> <span class="n">fut_zscore</span> <span class="o">=</span> <span class="n">_calc_fut_stats</span><span class="p">(</span><span class="n">ds_fut</span><span class="p">,</span> <span class="n">window_width</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fut_mean_bc</span> <span class="o">=</span> <span class="n">fut_mean</span> <span class="o">+</span> <span class="n">shift</span><span class="o">.</span><span class="n">uas</span>
<span class="n">fut_std_bc</span> <span class="o">=</span> <span class="n">fut_std</span> <span class="o">*</span> <span class="n">scale</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fut_corrected</span> <span class="o">=</span> <span class="p">(</span><span class="n">fut_zscore</span> <span class="o">*</span> <span class="n">fut_std_bc</span><span class="p">)</span> <span class="o">+</span> <span class="n">fut_mean_bc</span>
</pre></div>
</div>
</div>
<div class="section" id="Visualize-the-Correction">
<h3>Visualize the Correction<a class="headerlink" href="#Visualize-the-Correction" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">gaus</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">doy</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">mean</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">day</span><span class="o">=</span><span class="n">doy</span><span class="p">)</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lon</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">b</span> <span class="o">=</span><span class="n">std</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">day</span><span class="o">=</span><span class="n">doy</span><span class="p">)</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lon</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">mu</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fut_typ_mean</span><span class="p">,</span> <span class="n">fut_typ_std</span><span class="p">,</span> <span class="n">fut_typ_zscore</span> <span class="o">=</span> <span class="n">_calc_stats</span><span class="p">(</span><span class="n">ds_fut</span><span class="p">,</span> <span class="n">window_width</span><span class="p">)</span>
<span class="n">fut_typ_mean_bc</span> <span class="o">=</span> <span class="n">fut_typ_mean</span> <span class="o">+</span> <span class="n">shift</span>
<span class="n">fut_typ_std_bc</span> <span class="o">=</span> <span class="n">fut_typ_std</span> <span class="o">*</span> <span class="n">scale</span>

<span class="n">doy</span><span class="o">=</span><span class="mi">20</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">gaus</span><span class="p">(</span><span class="n">hist_mean</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">hist_std</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">doy</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;historical model&#39;</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">gaus</span><span class="p">(</span><span class="n">meas_mean</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">meas_std</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">doy</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;measured&#39;</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">gaus</span><span class="p">(</span><span class="n">fut_typ_mean</span><span class="p">,</span> <span class="n">fut_typ_std</span><span class="p">,</span> <span class="n">doy</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;raw future model&#39;</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">gaus</span><span class="p">(</span><span class="n">fut_typ_mean_bc</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">fut_typ_std_bc</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">doy</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;corrected future model&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x7fd965e84af0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../../../_images/repos_NCAR_notebook-gallery_notebooks_Run-Anywhere_Bias-Correction_bias_correction_27_1.png" src="../../../../../../_images/repos_NCAR_notebook-gallery_notebooks_Run-Anywhere_Bias-Correction_bias_correction_27_1.png" />
</div>
</div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2020, Pangeo Developers.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.4.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>